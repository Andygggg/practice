import{a as X,o as _,d as h,e as t,F as I,f as M,t as e,j as b,k as v,l as w,p as F,h as P,r as x,i as q,w as U,v as Z,g as tt}from"./index-D4CREDOg.js";import{M as et}from"./MakeTable-gIQq4Yby.js";import{M as k}from"./MakeButton-d0REwZ0d.js";import{M as W}from"./MakeModal-Dd5IaN2W.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{X as Y}from"./xlsx-Bn6iEmRa.js";const G=i=>(F("data-v-8c862f2d"),i=i(),P(),i),lt={class:"modal_box"},st={class:"row gx-1"},at=G(()=>t("span",null,"鑽探日報表：",-1)),ot={class:"form-select","aria-label":"Default select example"},nt=G(()=>t("option",{selected:""},"請選擇報表",-1)),ct=["value"],rt={class:"row gx-1"},dt=G(()=>t("span",null,"試驗室報表：",-1)),it={class:"form-select","aria-label":"Default select example"},ut=G(()=>t("option",{selected:""},"請選擇報表",-1)),pt=["value"],_t={__name:"exportGintModal",setup(i){const r=X([{value:0,text:"s-1-1"},{value:1,text:"q-1-1"},{value:2,text:"a-1-1"}]);return(S,y)=>(_(),h("div",lt,[t("div",st,[at,t("select",ot,[nt,(_(!0),h(I,null,M(r,p=>(_(),h("option",{key:p.value,value:p.value},e(p.text),9,ct))),128))])]),t("div",rt,[dt,t("select",it,[ut,(_(!0),h(I,null,M(r,p=>(_(),h("option",{key:p.value,value:p.value},e(p.text),9,pt))),128))])]),b(k,{btn_class:"btn_blue",class:"long_btn"},{default:v(()=>[w("匯出")]),_:1})]))}},ht=T(_t,[["__scopeId","data-v-8c862f2d"]]),H=i=>(F("data-v-924f36b9"),i=i(),P(),i),bt={key:0,class:"export_box"},vt=H(()=>t("span",null,"支援上傳類型：CSV, XLSX 檔案",-1)),ft=H(()=>t("span",null,"僅支援單一檔案匯入，透過點擊按鈕進行匯入",-1)),mt={key:1,class:"excel_box"},xt={class:"row gx-1"},yt={class:"col-4"},gt={class:"col-4"},wt={class:"row gx-1 gy-1"},kt={class:"col-4"},St={class:"col-4"},Dt={class:"col-4"},$t={class:"col-4"},Lt={class:"col-4"},Ct={class:"excel_table"},It={class:"table-striped table-bordered"},Rt=H(()=>t("thead",null,[t("tr",null,[t("th",{rowspan:"2",width:"7%"},"孔號Hole No."),t("th",{rowspan:"2",width:"5%"},"樣號Sample No."),t("th",{rowspan:"2",width:"5%"},"深度Depth m"),t("th",{rowspan:"2",width:"5%"},"含水量wn %"),t("th",{rowspan:"2",width:"5%"},"比重Gs"),t("th",{rowspan:"2",width:"5%"},"液性 限度 LL"),t("th",{rowspan:"2",width:"5%"},"塑性 指數 PI"),t("th",{colspan:"4",width:"16%"},"粒徑分析 Grain Size %"),t("th",{rowspan:"2",width:"5%"},"均勻係數Cu"),t("th",{rowspan:"2",width:"5%"},"曲率係數Cc"),t("th",{rowspan:"2",width:"5%"},"分類符號 Group Symbol"),t("th",{rowspan:"2",width:"5%"},"群組名稱 Group Name"),t("th",{rowspan:"2",width:"15%"},"土壤描述 Soil Description"),t("th",{colspan:"2",width:"12%"},"備註 Remark")]),t("tr",null,[t("th",null,"礫石Gravel"),t("th",null,"砂Sand"),t("th",null,"粉土Silt"),t("th",null,"粘土Clay"),t("th",null,"試驗種類Type of Test"),t("th",null,"其他說明 Note")])],-1)),jt={class:"btn_box"},Mt={__name:"importLabReportModal",setup(i){const r=x({id:"23130",projectId:"21110",projectName:"123",LabDate:"23",report:"34",tester:"45",checker:"6",list:[{Hole:"1",Sample:"2",Depth:"3",Wn:"4",Gs:"5",LL:"6",PI:"7",Gravel:"8",Sand:"9",Silt:"10",Clay:"11",Cu:"12",Cc:"13",Name:"14",Symbol:"14-1",Description:"15",type:"16",other:"17"}]}),S=q(()=>Object.keys(r.value).length===0),y=x(null),p=()=>{y.value.click()},D=l=>{const o=l[l.length-1].type;if(o==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||o==="text/csv"){const s=l[l.length-1],d=new FileReader;d.onload=u=>{let a,g;const L=u.target.result,C=O(L),m=Y.read(btoa(C),{type:"base64"});for(let f=0;f<m.SheetNames.length;f++){const R=m.SheetNames[f];g=m.Sheets[R],a=Y.utils.sheet_to_json(g),R==="分類報告"&&f===0&&$(a)}},d.readAsArrayBuffer(s)}else alert("不支援的檔案格式！僅支援上傳 XLSX, CSV 檔案")},O=l=>{let o="";for(let d=0;d<l.byteLength/10240;++d)o+=String.fromCharCode.apply(null,new Uint8Array(l.slice(d*10240,d*10240+10240)));return o+=String.fromCharCode.apply(null,new Uint8Array(l.slice(l.byteLength/10240*10240))),o},$=l=>{const o=l.length,s=Object.keys(l[0]),d=Object.keys(l[o-3]),u=Object.keys(l[o-2]),a=Object.keys(l[o-1]),g=l[o-1][a[3]],L=24*60*60*1e3,C=new Date(1899,11,31),m=g*L,f=new Date(C.getTime()+m),R=f.getFullYear(),z=(f.getMonth()+1).toString().padStart(2,"0"),E=f.getDate().toString().padStart(2,"0"),J=`${R}-${z}-${E}`,A=[];for(let j=3;j<o-3;j++){const n=Object.keys(l[j]);if(n.length>1){const c=l[j],Q={Hole:c[n[0]],Sample:c[n[1]],Depth:c[n[2]],Wn:c[n[3]],Gs:c[n[4]],LL:c[n[5]],PI:c[n[6]],Gravel:c[n[7]],Sand:c[n[8]],Silt:c[n[9]],Clay:c[n[10]],Cu:c[n[11]],Cc:c[n[12]],Symbol:c[n[13]],Name:c[n[14]],Description:c[n[15]],type:c[n[16]],other:c[n[17]]};A.push(Q)}}const K={id:l[0][s[0]],projectId:l[0][s[1]],list:A,projectName:l[o-3][d[2]],LabDate:J,report:l[o-2][u[0]],tester:l[o-1][a[1]],checker:""};Object.assign(r.value,K)},B=()=>{r.value={},y.value=null},V=()=>{console.log("save")};return(l,o)=>S.value?(_(),h("div",bt,[t("div",{id:"photo_area",class:"excel_upload",onClick:p},[b(k,{btn_class:"btn_blue"},{default:v(()=>[w(" 匯入檔案 ")]),_:1}),vt,ft,t("input",{type:"file",ref_key:"inputExcel",ref:y,class:"d-none",accept:".csv,.xlsx",multiple:"",onChange:o[0]||(o[0]=s=>D(s.target.files))},null,544)])])):(_(),h("div",mt,[t("div",xt,[t("span",yt,"Id："+e(r.value.id),1),t("span",gt,"projectId："+e(r.value.projectId),1)]),t("div",wt,[t("span",kt,"計畫名稱："+e(r.value.projectName),1),t("span",St,"試驗日期："+e(r.value.LabDate),1),t("span",Dt,e(r.value.report),1),t("span",$t,"試驗者："+e(r.value.tester),1),t("span",Lt,"報告簽署人："+e(r.value.checker),1)]),t("div",Ct,[t("table",It,[Rt,t("tbody",null,[(_(!0),h(I,null,M(r.value.list,(s,d)=>(_(),h("tr",{key:d},[t("td",null,e(s.Hole),1),t("td",null,e(s.Sample),1),t("td",null,e(s.Depth),1),t("td",null,e(s.Wn),1),t("td",null,e(s.Gs),1),t("td",null,e(s.LL),1),t("td",null,e(s.PI),1),t("td",null,e(s.Gravel),1),t("td",null,e(s.Sand),1),t("td",null,e(s.Silt),1),t("td",null,e(s.Clay),1),t("td",null,e(s.Cu),1),t("td",null,e(s.Cc),1),t("td",null,e(s.Symbol),1),t("td",null,e(s.Name),1),t("td",null,e(s.Description),1),t("td",null,e(s.type),1),t("td",null,e(s.other),1)]))),128))])])]),t("div",jt,[b(k,{btn_class:"btn_blue",onClick:B},{default:v(()=>[w(" 重置資料 ")]),_:1}),b(k,{btn_class:"btn_blue",style:{"margin-left":"1rem"},onClick:V},{default:v(()=>[w(" 儲存 ")]),_:1})])]))}},Gt=T(Mt,[["__scopeId","data-v-924f36b9"]]),N=i=>(F("data-v-68fc6f35"),i=i(),P(),i),Nt={class:"labReport_box"},Ot={class:"list_box"},Bt={class:"functionBar"},Vt={class:"btn_row"},Xt=N(()=>t("i",{class:"bx bx-upload"},null,-1)),Ft=N(()=>t("i",{class:"bx bxs-download"},null,-1)),Pt={class:"search_box"},Tt=N(()=>t("span",null,"關鍵字搜尋：",-1)),Ht=["value"],At={class:"input_box"},Ut=N(()=>t("i",{class:"bx bx-search-alt-2"},null,-1)),Wt={class:"table_box"},Yt={__name:"List",setup(i){const r=X([{key:"hole",label:"孔位",sort:!1},{key:"Reporter",label:"Report By",sort:!1},{key:"date",label:"日期",sort:!1}]),S=x([{hole:"s-1-2",Reporter:"陳冠宇",date:"2024-06-21"},{hole:"e-1-1",Reporter:"陳冠宇",date:"2024-06-21"},{hole:"r-1-1",Reporter:"陳冠宇",date:"2024-06-21"},{hole:"a-1-1",Reporter:"陳冠宇",date:"2024-06-23"},{hole:"a-1-1",Reporter:"陳冠宇",date:"2024-06-22"}]),y=X([{value:0,text:"當日"},{value:1,text:"all"}]),p=x(0),D=x(""),O=q(()=>{let d;if(p.value==0){const u=new Date,a=u.getFullYear(),g=(u.getMonth()+1).toString().padStart(2,"0"),L=u.getDate().toString().padStart(2,"0"),C=`${a}-${g}-${L}`;d=S.value.filter(m=>m.date==C)}else d=S.value;return d.filter(u=>u.hole.toLowerCase().includes(D.value))}),$=x(!1),B=()=>{$.value=!0},V=()=>{$.value=!1},l=x(!1),o=()=>{l.value=!0},s=()=>{l.value=!1};return(d,u)=>(_(),h(I,null,[t("div",Nt,[t("div",Ot,[t("div",Bt,[t("div",Vt,[b(k,{btn_class:"btn_blue",onClick:o},{default:v(()=>[Xt,w("試驗室報表匯入 ")]),_:1}),b(k,{btn_class:"btn_blue",style:{"margin-left":"1rem"},onClick:B},{default:v(()=>[Ft,w("Gint表匯出 ")]),_:1})]),t("div",Pt,[Tt,U(t("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":u[0]||(u[0]=a=>p.value=a)},[(_(!0),h(I,null,M(y,a=>(_(),h("option",{key:a.value,value:a.value},e(a.text),9,Ht))),128))],512),[[Z,p.value]]),t("div",At,[U(t("input",{type:"text",placeholder:"請輸入關鍵字","onUpdate:modelValue":u[1]||(u[1]=a=>D.value=a)},null,512),[[tt,D.value]]),Ut])])]),t("div",Wt,[b(et,{table_header:r,table_data:O.value,table_scroll:"50vh",table_pagination:!0,table_page:8},{"cell(hole)":v(a=>[t("span",null,e(a.value),1)]),"cell(Reporter)":v(a=>[t("span",null,e(a.value),1)]),"cell(date)":v(a=>[t("span",null,e(a.value),1)]),_:1},8,["table_header","table_data"])])])]),b(W,{"modal-open":$.value,title:"Gint表匯出",onCloseEvent:V},{default:v(()=>[b(ht)]),_:1},8,["modal-open"]),b(W,{"modal-open":l.value,title:"試驗室報表匯入",onCloseEvent:s},{default:v(()=>[b(Gt)]),_:1},8,["modal-open"])],64))}},Zt=T(Yt,[["__scopeId","data-v-68fc6f35"]]);export{Zt as default};
