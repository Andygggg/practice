import{o as n,d as c,j as d,k as _,l as m,p as X,h as E,e,i as F,r as v,F as g,f as S,t as b,a as B,w as N,v as R,g as T}from"./index-Cr02CvhY.js";import{M as W}from"./MakeTable-C459SRxN.js";import{M as x}from"./MakeButton-frdMjJxs.js";import{M as j}from"./MakeModal-CFIpvW8i.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{X as k}from"./xlsx-Bn6iEmRa.js";const O=u=>(X("data-v-72f35b22"),u=u(),E(),u),q={class:"modal_box"},z=O(()=>e("div",{class:"row gx-1"},[e("span",null,"孔位名稱："),e("input",{type:"text",class:"form-control"})],-1)),G=O(()=>e("div",{class:"row gx-1"},[e("span",null,"孔位位置："),e("input",{type:"text",class:"form-control"})],-1)),J={__name:"addHoleModal",setup(u){return(w,p)=>(n(),c("div",q,[z,G,d(x,{btn_class:"btn_blue",class:"long_btn"},{default:_(()=>[m("儲存")]),_:1})]))}},K=H(J,[["__scopeId","data-v-72f35b22"]]),A=u=>(X("data-v-3d5c8465"),u=u(),E(),u),P={key:0,class:"export_box"},Q=A(()=>e("span",null,"支援上傳類型：CSV, XLSX 檔案",-1)),Y=A(()=>e("span",null,"僅支援單一檔案匯入，透過點擊按鈕進行匯入",-1)),Z={key:1,class:"excel_table"},ee={class:"table-striped table-bordered"},te=A(()=>e("th",null,"NO.",-1)),se={class:"btn_box"},le={__name:"importHoleModal",setup(u){const w=F(()=>i.value.headers.length===0&&i.value.data.length===0),p=v(null),$=()=>{p.value.click()},i=v({headers:[],data:[]}),f=s=>{const r=s[s.length-1].type;if(r==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"||r==="text/csv"){const o=s[s.length-1],l=new FileReader;l.onload=a=>{const t=a.target.result,h=I(t),D=k.read(btoa(h),{type:"base64"}),U=D.SheetNames[0],V=D.Sheets[U];i.value.headers=y(V),i.value.data=k.utils.sheet_to_json(V)},l.readAsArrayBuffer(o),console.log(i.value)}else alert("不支援的檔案格式！僅支援上傳 XLSX, CSV 檔案")},I=s=>{let r="";for(let l=0;l<s.byteLength/10240;++l)r+=String.fromCharCode.apply(null,new Uint8Array(s.slice(l*10240,l*10240+10240)));return r+=String.fromCharCode.apply(null,new Uint8Array(s.slice(s.byteLength/10240*10240))),r},y=s=>{const r=[],o=k.utils.decode_range(s["!ref"]),l=o.s.r;for(let a=o.s.c;a<=o.e.c;++a){const t=s[k.utils.encode_cell({c:a,r:l})];let h="XXX";if(t&&t.t)h=k.utils.format_cell(t);else continue;r.push({field:h,name:h,label:h})}return r},L=()=>{i.value={headers:[],data:[]},p.value=null},C=()=>{console.log("save")};return(s,r)=>w.value?(n(),c("div",P,[e("div",{id:"photo_area",class:"excel_upload",onClick:$},[d(x,{btn_class:"btn_blue"},{default:_(()=>[m(" 匯入檔案 ")]),_:1}),Q,Y,e("input",{type:"file",ref_key:"inputExcel",ref:p,class:"d-none",accept:".csv,.xlsx",multiple:"",onChange:r[0]||(r[0]=o=>f(o.target.files))},null,544)])])):(n(),c("div",Z,[e("table",ee,[e("thead",null,[e("tr",null,[te,(n(!0),c(g,null,S(i.value.headers,(o,l)=>(n(),c("th",{key:l},b(o.name),1))),128))])]),e("tbody",null,[(n(!0),c(g,null,S(i.value.data,(o,l)=>(n(),c("tr",{key:l},[e("td",null,b(l+1),1),(n(!0),c(g,null,S(Object.keys(o),(a,t)=>(n(),c("td",{key:t},b(o[a]),1))),128))]))),128))])]),e("div",se,[d(x,{btn_class:"btn_blue",onClick:L},{default:_(()=>[m(" 重置資料 ")]),_:1}),d(x,{btn_class:"btn_blue",style:{"margin-left":"1rem"},onClick:C},{default:_(()=>[m(" 儲存 ")]),_:1})])]))}},ae=H(le,[["__scopeId","data-v-3d5c8465"]]),M=u=>(X("data-v-0ce1f278"),u=u(),E(),u),oe={class:"position_assign_box"},ne={class:"list_box"},ce={class:"functionBar"},ue={class:"btn_row"},re=M(()=>e("i",{class:"bx bxs-calendar-plus"},null,-1)),ie=M(()=>e("i",{class:"bx bxs-download"},null,-1)),de={class:"search_box"},_e=M(()=>e("span",null,"關鍵字搜尋：",-1)),pe=["value"],ve={class:"input_box"},fe=M(()=>e("i",{class:"bx bx-search-alt-2"},null,-1)),he={class:"table_box"},me={key:0},be={key:1},xe={key:2},ye={__name:"List",setup(u){const w=B([{key:"name",label:"孔位名稱",sort:!1},{key:"status",label:"執行狀態",sort:!1},{key:"position",label:"孔位位置",sort:!1}]),p=v([{name:"s-1-1",status:null,position:"813 高雄市左營區重光路32號"},{name:"A-1-1",status:null,position:"813 高雄市左營區重光路32號"},{name:"s-1-1",status:null,position:"813 高雄市左營區重光路32號"},{name:"s-1-1",status:null,position:"813 高雄市左營區重光路32號"},{name:"c-1-1",status:null,position:"813 高雄市左營區重光路32號"},{name:"g-1-1",status:!1,position:"813 高雄市左營區重光路32號"},{name:"s-1-1",status:!1,position:"813 高雄市左營區重光路32號"},{name:"F-1-1",status:!1,position:"813 高雄市左營區重光路32號"},{name:"s-1-1",status:!0,position:"813 高雄市左營區重光路32號"},{name:"s-1-1",status:!0,position:"813 高雄市左營區重光路32號"},{name:"s-1-1",status:!0,position:"813 高雄市左營區重光路32號"}]),$=B([{value:"",text:"all"},{value:null,text:"未執行"},{value:!1,text:"執行中"},{value:!0,text:"已完成"}]),i=v(""),f=v(""),I=F(()=>f.value===""&&i.value===""?p.value:p.value.filter(a=>a.status===i.value).filter(a=>a.name.toLowerCase().includes(f.value))),y=v(!1),L=()=>{y.value=!0},C=()=>{y.value=!1},s=v(!1),r=()=>{s.value=!0},o=()=>{s.value=!1};return(l,a)=>(n(),c(g,null,[e("div",oe,[e("div",ne,[e("div",ce,[e("div",ue,[d(x,{btn_class:"btn_blue",onClick:L},{default:_(()=>[re,m("新增孔位")]),_:1}),d(x,{btn_class:"btn_blue",style:{"margin-left":"1rem"},onClick:r},{default:_(()=>[ie,m("匯入孔位 ")]),_:1})]),e("div",de,[_e,N(e("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":a[0]||(a[0]=t=>i.value=t)},[(n(!0),c(g,null,S($,t=>(n(),c("option",{key:t.value,value:t.value},b(t.text),9,pe))),128))],512),[[R,i.value]]),e("div",ve,[N(e("input",{type:"text",placeholder:"請輸入關鍵字","onUpdate:modelValue":a[1]||(a[1]=t=>f.value=t)},null,512),[[T,f.value]]),fe])])]),e("div",he,[d(W,{table_header:w,table_data:I.value,table_scroll:"50vh",table_pagination:!0,table_page:8},{"cell(name)":_(t=>[e("span",null,b(t.value),1)]),"cell(status)":_(t=>[t.value==null?(n(),c("span",me,"未執行")):t.value?(n(),c("span",xe,"已完成")):(n(),c("span",be,"執行中"))]),"cell(position)":_(t=>[e("span",null,b(t.value),1)]),_:1},8,["table_header","table_data"])])])]),d(j,{"modal-open":y.value,title:"新增孔位",onCloseEvent:C},{default:_(()=>[d(K,{onCloseEvent:C})]),_:1},8,["modal-open"]),d(j,{"modal-open":s.value,title:"匯入孔位",onCloseEvent:o},{default:_(()=>[d(ae)]),_:1},8,["modal-open"])],64))}},$e=H(ye,[["__scopeId","data-v-0ce1f278"]]);export{$e as default};
