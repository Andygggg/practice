import{z as w,r as g,N as h,E as N,o as P,d as $,e as t,w as u,g as b,B as E,F as M,q as B,p as C,h as V,l as I,A as L,a as D,j as y,k as p,u as k,t as x}from"./index-Cr02CvhY.js";import{M as T}from"./MakeButton-frdMjJxs.js";import{M as j}from"./MakeModal-CFIpvW8i.js";import{M as q}from"./MakeTable-C459SRxN.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F=w("controlProduct",()=>{const c=g([]),d=async()=>{try{await h.get("api/andyhello-api/admin/products?page=:page").then(l=>{l.data.success&&(c.value=l.data.products)})}catch(l){console.log(l)}};return{product_list:c,getProductList:d,addProduct:l=>{try{h.post("api/andyhello-api/admin/product",{data:l}).then(e=>{e.data.success&&d(),alert(e.data.message)})}catch(e){console.log(e)}},editsProduct:l=>{try{h.put(`api/andyhello-api/admin/product/${l.id}`,{data:l}).then(e=>{console.log(e),e.data.success&&d(),alert(e.data.message)})}catch(e){console.log(e)}},uploadProductImg:async l=>{try{const{success:e,imageUrl:n}=(await h.post("api/andyhello-api/admin/upload",l)).data;if(e)return n}catch{console.log()}},delProduct:l=>{try{console.log(l),confirm("確定刪除?")&&h.delete(`api/andyhello-api/admin/product/${l}`).then(n=>{console.log(n),n.data.success&&d(),alert(n.data.message)})}catch(e){console.log(e)}}}}),r=c=>(C("data-v-946ea516"),c=c(),V(),c),z={class:"row"},A={class:"col-sm-4"},H=r(()=>t("div",{class:"mb-3"},[t("label",{for:"image",class:"form-label"},"輸入圖片網址"),t("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結"})],-1)),O={class:"mb-3"},G=r(()=>t("label",{for:"customFile",class:"form-label"},[I("或 上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1)),J=["src"],K=B('<div class="mt-5" data-v-946ea516><div class="mb-3 input-group" data-v-946ea516><input type="url" class="form-control form-control" placeholder="請輸入連結" data-v-946ea516><button type="button" class="btn btn-outline-danger" data-v-946ea516>移除</button></div><div data-v-946ea516><button class="btn btn-outline-primary btn-sm d-block w-100" data-v-946ea516>新增圖片</button></div></div>',1),Q={class:"col-sm-8"},R={class:"mb-3"},W=r(()=>t("label",{for:"title",class:"form-label"},"標題",-1)),X={class:"row gx-2"},Y={class:"mb-3 col-md-6"},Z=r(()=>t("label",{for:"category",class:"form-label"},"分類",-1)),tt={class:"mb-3 col-md-6"},et=r(()=>t("label",{for:"price",class:"form-label"},"單位",-1)),ot={class:"row gx-2"},lt={class:"mb-3 col-md-6"},st=r(()=>t("label",{for:"origin_price",class:"form-label"},"原價",-1)),at={class:"mb-3 col-md-6"},ct=r(()=>t("label",{for:"price",class:"form-label"},"售價",-1)),nt=r(()=>t("hr",null,null,-1)),dt={class:"mb-3"},rt=r(()=>t("label",{for:"description",class:"form-label"},"產品描述",-1)),it={class:"mb-3"},ut=r(()=>t("label",{for:"content",class:"form-label"},"說明內容",-1)),pt={class:"mb-3"},_t={class:"form-check"},mt=r(()=>t("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1)),bt={__name:"ProductModal",props:{product:{type:Object,default(){return{}}}},emits:["closeEvent"],setup(c,{emit:d}){const _=d,f=c,m=()=>{_("closeEvent")},i=F(),l=()=>{e.value.id?i.editsProduct(e.value):i.addProduct(e.value),m()},e=g({});N(()=>f.product,s=>{e.value=s,n.value.value=null},{deep:!0});const n=g(null),v=async()=>{const s=n.value.files[0],o=new FormData;o.append("file-to-upload",s),e.value.imageUrl=await i.uploadProductImg(o)};return(s,o)=>(P(),$(M,null,[t("div",z,[t("div",A,[H,t("div",O,[G,t("input",{type:"file",id:"customFile",ref_key:"inputFile",ref:n,onChange:v,class:"form-control"},null,544)]),t("img",{class:"img-fluid",alt:"",src:e.value.imageUrl},null,8,J),K]),t("div",Q,[t("div",R,[W,u(t("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":o[0]||(o[0]=a=>e.value.title=a),placeholder:"請輸入標題"},null,512),[[b,e.value.title]])]),t("div",X,[t("div",Y,[Z,u(t("input",{type:"text",class:"form-control",id:"category","onUpdate:modelValue":o[1]||(o[1]=a=>e.value.category=a),placeholder:"請輸入分類"},null,512),[[b,e.value.category]])]),t("div",tt,[et,u(t("input",{type:"text",class:"form-control",id:"unit","onUpdate:modelValue":o[2]||(o[2]=a=>e.value.unit=a),placeholder:"請輸入單位"},null,512),[[b,e.value.unit]])])]),t("div",ot,[t("div",lt,[st,u(t("input",{type:"number",class:"form-control",id:"origin_price","onUpdate:modelValue":o[3]||(o[3]=a=>e.value.origin_price=a),placeholder:"請輸入原價"},null,512),[[b,e.value.origin_price]])]),t("div",at,[ct,u(t("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":o[4]||(o[4]=a=>e.value.price=a),placeholder:"請輸入售價"},null,512),[[b,e.value.price]])])]),nt,t("div",dt,[rt,u(t("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":o[5]||(o[5]=a=>e.value.description=a),placeholder:"請輸入產品描述"},null,512),[[b,e.value.description]])]),t("div",it,[ut,u(t("textarea",{type:"text",class:"form-control",id:"content","onUpdate:modelValue":o[6]||(o[6]=a=>e.value.content=a),placeholder:"請輸入產品說明內容"},null,512),[[b,e.value.content]])]),t("div",pt,[t("div",_t,[u(t("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":o[7]||(o[7]=a=>e.value.is_enabled=a),id:"is_enabled"},null,512),[[E,e.value.is_enabled]]),mt])])])]),t("div",{class:"footer"},[t("button",{type:"button",class:"btn btn_save",onClick:l},"確認"),t("button",{type:"button",class:"btn btn_cancel",onClick:m},"取消")])],64))}},vt=U(bt,[["__scopeId","data-v-946ea516"]]),ft=w("useFilter",()=>({currency:d=>parseInt(d,10).toLocaleString()})),S=c=>(C("data-v-4b2963bb"),c=c(),V(),c),ht={class:"product_box"},gt={class:"btn_box"},yt={key:0,class:"text-success"},kt={key:1,class:"text-muted"},xt={class:"btn-group"},Pt=["onClick"],$t=S(()=>t("i",{class:"bx bxs-pencil"},null,-1)),wt=[$t],Mt=["onClick"],Ct=S(()=>t("i",{class:"bx bxs-trash"},null,-1)),Vt=[Ct],It={__name:"ProductList",setup(c){const d=ft(),_=F();L(()=>{_.getProductList()});const f=D([{key:"category",label:"分類",sort:!1,width:"120"},{key:"title",label:"產品名稱",sort:!1},{key:"origin_price",label:"原價",sort:!1,width:"120"},{key:"price",label:"售價",sort:!1,width:"120"},{key:"is_enabled",label:"是否啟用",sort:!1,width:"100"},{key:"edit",label:"編輯",sort:!1,width:"200"}]),m=g({}),i=g(!1),l=(n,v)=>{n?m.value={}:m.value={...v},i.value=!0},e=()=>{i.value=!1};return(n,v)=>(P(),$(M,null,[t("div",ht,[t("div",gt,[y(T,{btn_class:"btn_blue",onClick:v[0]||(v[0]=s=>l(!0))},{default:p(()=>[I("新增產品")]),_:1})]),y(q,{table_header:f,table_data:k(_).product_list,table_scroll:"70vh",table_pagination:!0,table_page:8},{"cell(category)":p(s=>[t("span",null,x(s.value),1)]),"cell(title)":p(s=>[t("span",null,x(s.value),1)]),"cell(origin_price)":p(s=>[t("span",null,x(k(d).currency(s.value)),1)]),"cell(price)":p(s=>[t("span",null,x(k(d).currency(s.value)),1)]),"cell(is_enabled)":p(s=>[s.value?(P(),$("span",yt,"啟用")):(P(),$("span",kt,"未啟用"))]),"cell(edit)":p(s=>[t("div",xt,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:o=>l(!1,s.item)},wt,8,Pt),t("button",{class:"btn btn-outline-danger btn-sm",onClick:o=>k(_).delProduct(s.item.id)},Vt,8,Mt)])]),_:1},8,["table_header","table_data"])]),y(j,{"modal-open":i.value,title:"新增產品",onCloseEvent:e},{default:p(()=>[y(vt,{onCloseEvent:e,product:m.value},null,8,["product"])]),_:1},8,["modal-open"])],64))}},Bt=U(It,[["__scopeId","data-v-4b2963bb"]]);export{Bt as default};
